---
title: "Coding_Exercises"
author: "Sabrina Gobran"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## setup
```{r}
source("setup.R")
```

## load data
```{r}
data("knz_bison")

knz_bison
```

## Q1 Create a new column in the bison dataset that calculates the individualâ€™s age at the time of observation.
```{r}
knz_bison$age <- knz_bison$rec_year - knz_bison$animal_yob

head(knz_bison)
```


## Q2 Write a function that will first filter the bison dataset based on any user-specified weight threshold (returning the filtered dataset).
```{r}
weight_filter <- function(dataset, threshold) {
  dataset %>%
  filter(animal_weight >= threshold)
}

weight_filter(knz_bison, 1000)
```


## Q3 Create a boxplot showing weight distribution between male and female bison, and then conduct a t-test to see if weight is significantly difference between males and females.
```{r}
knz_bison %>%
  ggplot(aes(x = animal_sex, y = animal_weight)) +   
  geom_boxplot()

knz_bison %>% 
  levene_test(animal_weight ~ animal_sex)

knz_bison %>%
t_test(animal_weight ~ animal_sex, var.equal = FALSE, detailed = FALSE)
```

There is a significant difference in bison weight between males and females.
